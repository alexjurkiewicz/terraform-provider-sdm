# Adding Resources to strongDM

Resources in strongDM are the databases, servers, and clusters for which strongDM manages access.

## Leased Credentials

[Credential Leasing](https://www.strongdm.com/docs/architecture/leasing/)

## Example Usage

### MySQL Database

```hcl
variable "mysql-admin" {}
variable "mysql-pass" {}

resource "sdm_resource" "mysql" {
  mysql {
    name          = "mysql_prod_db"
    hostname      = "prod.mysql.corp.net"
    username      = var.mysql-admin
    password      = var.mysql-pass
    database      = "master"
    port          = 3306
  }
```

### SSH Server

SSH connections are authenticated using an RSA public/private key pair. This key is generated by strongDM when the resource is created. strongDM retains the private key and only exposes the public key which can be installed in the target server's `~/.ssh/authorized_keys` file.

```hcl
resource "sdm_resource" "rack_server" {
  ssh {
    name          = "admin_server"
    hostname      = "10.99.238.2"
    username      = "awsuser"
    port          = 22
  }

output "rack_server_public_key" {
  value = sdm_resource.rack_server.public_key
}
```

### RDP Server

```hcl
resource "sdm_resource" "win_server_2019" {
  rdp {
    name          = "windows server 2019"
    hostname      = "admin.windows.corp.net"
    username      = "Administrator"
    password      = var.win_admin_pass
    port          = 3389
  }
}
```

### Kubernetes (Amazon EKS)

```hcl
provider "aws" {}
provider "sdm" {}

variable "user_access_key_id" {}
variable "user_access_secret_key" {}

data "aws_eks_cluster" "myeks" {
    name = "cluster name"
}

resource "sdm_resource" "k8s_cluster" {
  amazon_eks {
    name = "My EKS Cluster"
    cluster_name = "cluster name"
    endpoint = replace(data.aws_eks_cluster.myeks.endpoint, "/https[[:punct:]][[:punct:]][[:punct:]]/", "")
    certificate_authority = base64decode(data.aws_eks_cluster.myeks.certificate_authority.0.data)
    certificate_authority_filename = "RAW_INPUT_TEXT"
    access_key = var.user_access_key_id
    secret_access_key = var.user_access_secret_key
    region = "us-west-2"
  }
}
```
